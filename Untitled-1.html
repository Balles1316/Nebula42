<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gamora: Rebirth of a Planet</title>
<style>
  body {
    margin: 0;
    background-color: #220000;
    color: white;
    font-family: monospace;
    overflow: hidden;
  }
  #hud {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(0,0,0,0.5);
    padding: 10px;
    border-radius: 10px;
  }
  #message {
    position: absolute;
    bottom: 20px;
    width: 100%;
    text-align: center;
    font-size: 20px;
  }
  canvas {
    display: block;
    background-image: url('nivel1.jpg');
    background-repeat: no-repeat;
    background-size: cover;
  }
</style>
</head>
<body>
<div id="hud">
  <div id="level">Level: 1 – The Burning Lands</div>
  <div id="temp">Temperature: 42°C</div>
  <div id="items">Heat orbs: 0 / 4</div>
</div>
<div id="message">Surface temperature critical. Begin cooling sequence.</div>

<canvas id="game" width="800" height="500"></canvas>

<script>
// ======= CONFIGURACIÓN GENERAL =======
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Imagen del astronauta
const astronautImg = new Image();
astronautImg.src = "astronaut.png"; // pon aquí tu imagen

// Jugador
let player = { x: 400, y: 250, size: 30, speed: 4 };

// Variables de juego
let temperature = 42;
let level = 1;
let collected = 0;
let goal = 4;
let itemName = "Heat orbs";
let items = [];
let message = "Surface temperature critical. Begin cooling sequence.";

// ======= FUNCIONES AUXILIARES =======
function random(min, max) {
  return Math.random() * (max - min) + min;
}

// ===== NIVEL 1: ORBES DE CALOR =====
function createHeatOrbs() {
  items = [];
  const total = Math.floor(random(10, 15));
  const validOrbs = new Set();
  while (validOrbs.size < goal) validOrbs.add(Math.floor(random(0, total)));
  for (let i = 0; i < total; i++) {
    items.push({
      x: random(30, 770),
      y: random(30, 470),
      size: 20,
      isValid: validOrbs.has(i),
      type: "fire"
    });
  }
}

// ===== NIVEL 2: GOTAS DE AGUA =====
function createWaterDrops() {
  items = [];
  for (let i = 0; i < 10; i++) {
    items.push({
      x: random(30, 770),
      y: random(30, 470),
      size: 15,
      isValid: i < 5,
      type: "water"
    });
  }
}

// ===== NIVEL 3: SEMILLAS =====
function createSeeds() {
  items = [];
  const total = Math.floor(random(10, 15));
  const validSeeds = new Set();
  while (validSeeds.size < 3) validSeeds.add(Math.floor(random(0, total)));
  for (let i = 0; i < total; i++) {
    items.push({
      x: random(30, 770),
      y: random(30, 470),
      size: 20,
      isValid: validSeeds.has(i),
      type: "seed"
    });
  }
}

// ===== PASAR DE NIVEL =====
function nextLevel() {
  level++;
  collected = 0;

  if (level === 2) {
    itemName = "Water drops";
    goal = 5;
    temperature = 38;
    message = "Moisture detected. Lakes forming.";
    canvas.style.backgroundImage = "url('nivel2.jpg')";
    createWaterDrops();
  } 
  else if (level === 3) {
    itemName = "Seeds";
    goal = 3;
    temperature = 33;
    message = "Vegetation restored. Oxygen levels rising.";
    canvas.style.backgroundImage = "url('nivel3.jpg')";
    createSeeds();
  } 
  else if (level === 4) {
    message = "Demo complete!";
    items = [];
  }
}

// Controles
let keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

// Inicializar
createHeatOrbs();

// ======= LOOP PRINCIPAL =======
function update() {
  // Movimiento
  if (keys["ArrowUp"] || keys["w"]) player.y -= player.speed;
  if (keys["ArrowDown"] || keys["s"]) player.y += player.speed;
  if (keys["ArrowLeft"] || keys["a"]) player.x -= player.speed;
  if (keys["ArrowRight"] || keys["d"]) player.x += player.speed;

  player.x = Math.max(20, Math.min(780, player.x));
  player.y = Math.max(20, Math.min(480, player.y));

  // Colisiones
  for (let i = items.length - 1; i >= 0; i--) {
    let dx = player.x - items[i].x;
    let dy = player.y - items[i].y;
    let dist = Math.sqrt(dx * dx + dy * dy);
    if (dist < player.size / 2 + items[i].size) {
      if (items[i].isValid) {
        collected++;
        temperature--;
      }
      items.splice(i, 1);
      if (collected >= goal) {
        nextLevel();
      }
    }
  }

  // ======= DIBUJO =======
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Dibujar ítems
  for (let item of items) {
    if (item.type === "fire") {
      const g = ctx.createRadialGradient(item.x, item.y, 5, item.x, item.y, 20);
      g.addColorStop(0, "yellow");
      g.addColorStop(0.5, "orange");
      g.addColorStop(1, "red");
      ctx.fillStyle = g;
    } else if (item.type === "water") {
      const g = ctx.createRadialGradient(item.x, item.y, 5, item.x, item.y, 15);
      g.addColorStop(0, "#aef");
      g.addColorStop(0.5, "#5cf");
      g.addColorStop(1, "#027");
      ctx.fillStyle = g;
    } else if (item.type === "seed") {
      const g = ctx.createRadialGradient(item.x, item.y, 5, item.x, item.y, 18);
      g.addColorStop(0, "#9f7");
      g.addColorStop(0.5, "#6d4");
      g.addColorStop(1, "#372");
      ctx.fillStyle = g;
    }
    ctx.beginPath();
    ctx.arc(item.x, item.y, item.size, 0, Math.PI * 2);
    ctx.fill();
  }

  // Astronauta
  ctx.drawImage(astronautImg, player.x - player.size, player.y - player.size, 60, 60);

  // HUD
  if (level === 1) document.getElementById("level").textContent = "Level: 1 – The Burning Lands";
  else if (level === 2) document.getElementById("level").textContent = "Level: 2 – The Water Returns";
  else if (level === 3) document.getElementById("level").textContent = "Level: 3 – Seeds of Life";

  document.getElementById("temp").textContent = "Temperature: " + temperature + "°C";
  document.getElementById("items").textContent = itemName + ": " + collected + " / " + goal;
  document.getElementById("message").textContent = message;

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
